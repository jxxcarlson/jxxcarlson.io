<!doctype html><html><head><title>Generative Art and Music | jxxcarlson</title><meta charset="utf-8"><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.1/highlight.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.1/languages/elm.min.js"></script><script>hljs.initHighlightingOnLoad();</script><link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.1/styles/default.min.css" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Open+Sans|Proza+Libre|Inconsolata" rel="stylesheet" type="text/css"></head><body><div class="header-logo"><img alt="Author's blog" src="/img/logo.png" width="35"></div><div class="navigation"><ul><li><a href="/about">Home</a></li><li><a href="/posts">Posts</a></li><li><a href="/apps">Apps</a></li><li><a href="/contact">Contact</a></li></ul></div><div class="sidebar"></div><div class="sidebar2"></div><div class="content"><h1>Generative Art and Music</h1><div class="post-metadata"><span>2020-11-19</span><span>•</span><a href="/tags/code">code</a><a href="/tags/fp">fp</a><a href="/tags/music">music</a><a href="/tags/art">art</a><a href="/tags/rc">rc</a></div><div class="markdown"><h1 id="rc-friday-show">RC Friday Show</h1>
<p><em>November 19, 2020</em> </p>
<p>The three pieces below, <em>Duet</em>, <em>Nervous Chase</em>, and <em>Space Invaders</em>, were written using Paul Hudak’s Haskell library, <em>Euterpea</em>. I’ve learned everything that went into these compositions from <em>The Haskell School of Music</em>, by Paul Hudak and Donya Quick, and also from <a href="http://donyaquick.com/">Donya Quick’s website</a> and other resources she has published on the web.</p>
<h4 id="duet">Duet</h4>
<audio controls="">
  <source src="/audio/duet.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 



<audio controls="">
  <source src="/audio/duet.wav" type="audio/x-wav">
  Your browser does not support the audio element.
</audio> 

<p>^^ High quality version</p>
<p><em>Duet</em> is constructed with traditional compositional principles, i.e., is not algorithmic.</p>
<h4 id="nervous-chase">Nervous Chase</h4>
 <audio controls="">
  <source src="/audio/nervousChase.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<p><em>Nervous Chase</em> is based on the notion of L-systems, a kind of formal grammar that Aristid Lindenmayer used
to describe the growth of plants.</p>
<h4 id="space-invasion">Space Invasion</h4>
<audio controls="">
  <source src="/audio/spaceInvasion.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<p><em>Space Invaders</em>, is based on random sequences of integers, some produced by a uniform probability distributions, others produced by random walk (Brownian motion). These sequences can be used to make visual art as well as music.  We illustrate this with points and  remarks and images at the end of this post.  </p>
<p>As a side note, both kinds of sequences can be used to produce noise: white noise and brown noise, respectively.  I find the first annoying (it is like static).  The latter is relaxing — more like the sound of the sea at dawn.</p>
<p>The image below depicts the three lines of MIDI music in <em>Space Invaders</em>.   Can you guess
which type of random sequence is used for each line of music?</p>
<p><img src="/img/random-white-brown.png" width="600"></p>
<p><strong>Comment.</strong> Musical composition is, among other things, the art of balancing novelty, repetition, and structure.  Pure randomness is fleetingly entertaining but not  musically satisfying.  If it is used, it must be managed so as to yield a composition with some structure.  <em>Space Invasion</em> achieves this to an extent by the use of three lines, each played on different instruments, with a variety of entrance and exit points.</p>
<h2 id="program-notes">Program Notes</h2>
<p>Here is the <a href="https://github.com/jxxcarlson/euterpea-exercises">repo for the code</a>.  It is badly in need of some cleanup and editing.  Soon!</p>
<p>Below is a short snippet of Euterpea code, the “theme” from which <em>Duet</em> is composed.  It reads as follows: <em>Make a line of music beginning with a whole note D in octave 1, playing first a D minor triad in whole notes.  Follow this by a 5-note passage in quarter notes and end with half-note whole-note resolution.</em></p>
<pre><code>bass1 :: Music Pitch
bass1 = line $ [ d 1 wn, f 1 wn, a 1 wn,  g 1 1, f 1 qn, e 1 qn, d 1 qn
               , c 1 qn, e 1 hn, d 1 wn]
</code></pre><h3 id="duet">Duet</h3>
<audio controls="">
  <source src="/audio/duet.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<p><a href="https://github.com/jxxcarlson/euterpea-exercises/blob/master/src/Duet.hs">Code</a></p>
<p>This piece is a duet between two bassoon-tuba combos, with a later entrance by a trombone ostinato.  It is composed using quasi-traditional rather than algorithmic methods, building up the piece by successive application of operators like <code>:+:</code> and <code>:=:</code> — the first joins pieces of music in series while the second stacks them in parallel. Here is a fragment derived from <code>bass1</code>:</p>
<pre><code>bass2 d = instrument Bassoon $ bass1 
       :=: (instrument Tuba $ transpose 19 $ offset d $ retro $ bass1)
</code></pre><p>It reads as follows: play <code>bass1</code> on bassoon and stack it against a line derived from it played on Tuba.  To derive that line, offset <code>bass1</code> by <code>d</code> whole notes and then transpose it up 19 semitones, that is, an octave and a perfect fifth.  While the delayed entrance can be any rational multiple of a whole note, we use small integer multiples here.  </p>
<p>Note that <code>bass2</code> is a function of type <code>Rational -&gt; Music Pitch</code>.  We use it to derive a set of four lines which we subsequently join end-to-end:</p>
<pre><code>b1 = bass2 0 :+: rest wn
b2 = transpose 5 $ bass2 2 :+: rest wn
b3 = retro $ transpose 7 $ bass2 4 :+: rest wn
b4 = retro $ transpose 5 $ bass2 2 :+: rest wn
</code></pre><p>Each phrase ends with a whole-note rest so that when the pieces are joined end-to-end, there is 
a bit of intervening silence.  The function <code>retro :: Music Pitch -&gt; Music Pitch</code> re-arranges
the given notes in reverse order.  This is a <a href="https://en.wikipedia.org/wiki/Retrograde_(music">classic compositional technique</a>):</p>
<blockquote>
<p>Retrograde was not mentioned in theoretical treatises prior to 1500.[1] Nicola Vicentino (1555) discussed the difficulty in finding canonic imitation: “At times, the fugue or canon cannot be discovered through the systems mentioned above, either because of the impediment of rests, or because one part is going up while another is going down, or because one part starts at the beginning and the other at the end. In such cases a student can begin at the end and work back to the beginning in order to find where and in which voice he should begin the canons.”[2] Vicentino derided those who achieved purely intellectual pleasure from retrograde (and similar permutations).” — <em>Wikipedia</em></p>
</blockquote>
<p>A long line is constructed using these derived parts:</p>
<pre><code>bass3 = b1 :+: b2 :+: b3 :+: b4 :+: dim 0.6 b1
</code></pre><p>The operator <code>dim 0.6</code> applies a <em>diminuendo</em> to its argument, the line <code>b1</code>. To achieve
a somewhat richer texture, a second part is composed as follows.</p>
<pre><code>ostinato1 = instrument Trombone $ sta 0.9 $  
   line [a 3 hn, d 3 hn, c 3 hn,  g 2 hn, e 3 hn, d 3 wn, rest wn]

ostinato2 = mSequence [0, 2, 7, 5, 0] ostinato1 
   :+: (instrument Trombone $ dim 0.5 $ transpose (-5) 
       $ line [a 3 hn, d 3 hn, c 3 hn,  g 2 hn, e 3 wn, d 3 2])
</code></pre><p>The function <code>sta 0.9</code> renders its argument with staccato articulation.  The function
<code>mSequence</code> makes a sequence out of the given phrase using the supplied list of intervals
to transpose the phrase:</p>
<pre><code>mSequence :: [Int] -&gt; Music a -&gt; Music a
mSequence [] m = rest 0
mSequence (i:is) m = (transpose i m) :+: (mSeq is m)
</code></pre><p>The last step is to stack the parts on top of one another:</p>
<pre><code>duet = bass3 :=: (offset 6 $ transpose 12 $ bass3) :=: (offset 12 $ ostinato2)
</code></pre><p>One plays the piece like this:</p>
<pre><code>playDev 6 duet
</code></pre><p>Here the number 6 is the device ID for the synthesizer I happen to be using (fluidsynth).
For MIDI output, I used</p>
<pre><code>writeMidi "duet.MID" duet
</code></pre><p>I imported the MIDI file into Logic Pro for processing: balancing the parts, adding more reverb, etc.
The edited MIDI file was exported to an audio file in AIFF format and then converted to MP3:</p>
<pre><code>ffmpeg -i duet.aiff duet.mp3
</code></pre><h3 id="nervous-chase">Nervous Chase</h3>
 <audio controls="">
  <source src="/audio/nervousChase.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<p><a href="https://github.com/jxxcarlson/euterpea-exercises/blob/master/src/NervousChase.hs">Code</a></p>
<p><em>Nervous Chase</em> is an exercise in the use of L-systems in musical composition, per Haskell School of Music, 
chapter 13.  <a href="https://en.wikipedia.org/wiki/L-system">L-systems</a> were developed in 1968 
by the Dutch-Hungarian theoretical biologist Aristid Lindenmayer as a mathematical model to describe
the growth and development of organisms such as algae and trees.  Here is a simple example.  The L-system
has two symbols, A and B, where A is the <em>axiom</em>.  It also has two <em>production rules</em>, A -&gt; AB and B -&gt; A.
Starting with the axiom, one uses the rules to generate ever more complex sequences of symbols:</p>
<pre><code>A -&gt; AB -&gt; ABA -&gt; ABAAB -&gt; ABAABABA -&gt; ...
</code></pre><p>One can use a system like this to generate a long string of symbols that can then be transcribed to music.
Here is the <em>RedAlgae</em> formal grammar of <em>The Haskell School of Music:</em></p>
<pre><code>redAlgae = DetGrammar 'a'
  [('a', "b|c"), ('b', "b"), ('c', "b|d"),
   ('d', "e\\d"), ('e', "f"), ('f', "g"),
   ('g', "h(a)"), ('h', "h"), ('|', "|"),
   ('(', "("), (')', ")"), ('/', "\\"),
   ('\\', "/")]
</code></pre><p>The twelve symbols “a” through “h” represent the twelve notes of a major scale with given starting pitch,
“/“ maps to a rest, “\” maps to rest four times as long.
The other symbols map to operators on <code>Music Pitch</code> values, with “(“ mapping to the operator “transpose up 9 semitones” (a major sixth), and “)” mappping to “transpose down a major sixth.”   These are slight variations on the text of Hudak, pp. 186-7.</p>
<p>The function below generates music from the <code>redAlgae</code> grammar
 given a length parameter <code>n</code>, an absolute pitch <code>ap</code>, and a duration value 
for notes, <code>dur</code>:</p>
<pre><code>lsMusic :: Int -&gt; AbsPitch -&gt; Dur -&gt; Music Pitch
lsMusic n ap dur = 
    strToMusic ap dur $ mconcat $ take n $ detGenerate redAlgae
</code></pre><p>The final piece is constructed from <code>lsMusic</code> using the operators <code>:+:</code> and <code>:=:</code> as well as
functions to modify the performance, e.g., <code>cre</code> for crescendo:</p>
<pre><code>nervousChase :: Int -&gt; AbsPitch -&gt; Dur -&gt; Music Pitch
nervousChase n ap dur = 
      cre 0.4 $ (instrument Xylophone $ phrase [Dyn (Loudness 70)] $ rest 2 :+: lsMusic n (ap + 7) (dur))
      :=: (cre 0.4 $ (dim 0.2 $ instrument Bassoon $ phrase [Dyn (Loudness 70), Art (Staccato 0.7)] $ lsMusic n ap (dur)))
</code></pre><p>It is important in a piece like this to have some kind of sectional structure.  Quite simple here, but it makes a difference.
The piece is played like this:</p>
<pre><code>playDev 6 $ nervousChase 15 40 sn
</code></pre><p>Here <code>sn</code> stands for “sixteenth note,” i.e., the rational number 1/16.</p>
<h3 id="space-invasion">Space Invasion</h3>
<audio controls="">
  <source src="/audio/spaceInvasion.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>


<p><a href="https://github.com/jxxcarlson/euterpea-exercises/blob/master/src/SpaceInvasion.lhs">Code</a></p>
<p><em>Space Invasion</em> is based on the code and ideas in  <a href="https://github.com/Euterpea/Euterpea2-Examples/blob/master/NoteLevel/RandomMusic.lhs">some notes of Donya Quick</a>.  The main new element here is the 
use of sequences of integers generated by bounded random walk as well as uniformly distributed sequences
of integers.  Here is the bounded random walk generator:</p>
<pre><code>boundedRandomWalk :: (Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; [Int]
boundedRandomWalk (lowerBound, upperBound) start step seed = 
    recInts (seed + magicNumber) (mkStdGen seed) where
        recInts current g = 
            let 
                (i,g') = next g 
                delta = (2 * (mod i 2) - 1) * step
                current' = bounce (lowerBound, upperBound) 
                           start step $ current + delta
            in current' : recInts current' g'
</code></pre><p>The function of <code>bounce</code> is to “bounce” integers into the specified range if they stray from it.
Music is generated from a random walk by the function below:</p>
<pre><code>melGen2 :: (Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; Music (Pitch, Volume)
melGen2 (lowerBound, upperBound) start step seed = 
    let 
        pitches = map pitch $ boundedRandomWalk2 
                 (lowerBound, upperBound) start step seed
        vols = randIntsRange (40,100) (seed + 1)
    in  line $ map (note sn) $ zip pitches vols
</code></pre><p>There is a similar function <code>melGen1</code> for generating music from the uniform distribution.
With this code in hand, one can construct the final piece:</p>
<pre><code>spaceInvasion s = chord [xylo s, bells s, marimba 12 s]

xylophone :: Dur -&gt; Int -&gt; Int -&gt; Dur -&gt; Dur -&gt; Int -&gt; Music (Pitch, Volume)
xylophone  n l h d r s = 
  instrument Xylophone $ dim d $ rit r $ cut n $ melGen1 (l, h) (345 + s)

marimba :: Dur -&gt; Int -&gt; Music (Pitch, Volume)
marimba n s = 
   instrument Marimba $ cre 0.5 $ acc 0.4  
      $ cut n $ melGen2 (30, 80) 30 2 (234 + s)

tubularBells n l h s = 
   instrument TubularBells $ cut n $ melGen2 (l, h) 45 4 (789 + s)

xylo s =  xylophone 5 10 110 0 0 s :+: rest 2 
          :+: xylophone (2 + hn) 10 110 0.5 0.5 (2 * s)

bells s = rest 1 :+: tubularBells 2 30 60 s :+: rest 1 
          :+: tubularBells 2 20 100 (2 * s)
</code></pre><h3 id="using-random-walk-to-generate-images">Using Random Walk to Generate Images</h3>
<p>All the images below were generated by random walk
using some Haskell code.  </p>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/Random_walk">Random Walk, Wikipedia</a></p>
</li>
<li><p><a href="https://en.wikipedia.org/wiki/Brownian_motion">Brownian Motion, Wikipedia</a></p>
</li>
</ul>
<p><a href="https://jxxcarlson.io/posts/2020-09-22-gen-art/">This post</a>
explains the basics of the code used.</p>
<h4 id="random-walk">Random Walk</h4>
<p>Generate successive points in the plane using random walk.  Then connect the dots.</p>
<p><img src="/img/brownianPath.png" width="600"></p>
<h4 id="cloud-shapes">Cloud Shapes</h4>
<p>Draw a small colored square centered at each of the points generated by the random walk.</p>
<p><img src="/img/brownianCloud.png" width="600"></p>
<h4 id="abstract-art">Abstract Art</h4>
<p>The same as above, but with larger squares with semi-transparent color (water color wash).
Need to experiment more with transparency.</p>
<p><img src="/img/dark.png" width="600"></p>
</div></div><div class="footer"><div style="float: left; padding-left: 12px">Built with Elmstatic</div><div class="link"><a href="https://booklib.io">Booklib.io</a></div><div class="link"><a href="https://markdown.minilatex.app/">Markdown.minilatex.app</a></div><div class="link"><a href="https://markdown.minilatex.app/">MathMarkdown Demo</a></div><div class="link"><a href="https://demo.minilatex.app/">Minilatex Demo</a></div><div class="link"><a href="https://reader.minilatex.app/">Minilatex Reader</a></div><div class="link"><a href="https://knode.io">knode.io</a></div><div class="link"><svg width="16" height="16" viewbox="0 0 16 16"><path fill="#fff" d="
M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z
            "></path></svg><a href="https://github.com/jxxcarlson/">GitHub</a></div></div><link href="/styles.css" rel="stylesheet" type="text/css"><style>body {
    padding:0px;
    margin:0px;
    background-color:#ffffff;
    color:#363636;
    font-family:Open Sans, Arial, sans-serif;
    font-size:15px;
    line-height:1.4em;
}

a {
    color:#1552b5;
    text-decoration:none;
}

code {
    font-family:Inconsolata, monospace;
}

pre  code {
    overflow-x:scroll !important;
}

h1, h2, h3, h4, h5, h6 {
    font-family:Proza Libre, Helvetica, sans-serif;
    line-height:1.1em;
}

h1 {
    font-size:2.66667em;
    margin-bottom:2.0202rem;
}

h2 {
    font-size:2em;
    margin-bottom:1.61616rem;
}

h3 {
    font-size:1.33333em;
    margin-bottom:1.21212rem;
}

h4 {
    font-size:1.2em;
    margin-bottom:0.80808rem;
}

h5, h6 {
    font-size:1em;
    margin-bottom:0.60606rem;
}

p {
    margin:auto auto 1.5rem;
}

small {
    font-size:65%;
}

.header-logo {
    padding-top:6px;
    text-align:center;
    background-color:#666666;
}

@media only screen and (min-width: 600px) {
    .header-logo {
        text-align:left;
    border-bottom:2px solid #3c8765;
    }
}

.navigation {
    text-align:center;
    border-bottom:2px solid #3c8765;
    background-color:#666666;
    color:#ffffff;
    padding:10px;
    margin-top:-20px;
}

@media only screen and (min-width: 600px) {
    .navigation {
        margin-top:0px;
    padding:0px;
    text-align:right;
    }
}

.navigation  ul {
    margin:0px;
    padding:0px;
}

@media only screen and (min-width: 600px) {
    .navigation  ul {
        line-height:50px;
    }
}

.navigation  li {
    display:inline-block;
    margin-right:20px;
}

.navigation  a {
    color:#ffffff;
    text-decoration:none;
}

.content {
    max-width:100vw;
}

@media only screen and (min-width: 600px) {
    .content {
        max-width:600px;
    }
}

.footer {
    text-align:center;
    border-top:2px solid #000000;
    background-color:#666666;
    color:#ffffff;
}

@media only screen and (min-width: 600px) {
    .footer {
        line-height:80px;
    text-align:right;
    }
}

@media only screen and (min-width: 600px) {
    .footer  .link {
        display:inline-block;
    margin-right:20px;
    }
}

.footer  a {
    color:#ffffff;
    text-decoration:none;
}

.footer  svg {
    padding-right:5px;
    vertical-align:baseline;
}

.post-metadata {
    margin-top:-0.5em;
    margin-bottom:2em;
}

.post-metadata  a, .post-metadata  span {
    display:inline-block;
    margin-right:5px;
}

.post-metadata  a {
    border:1px solid #e0e0e0;
    border-radius:3px;
    background-color:#f2f2f2;
    padding-left:5px;
    padding-right:5px;
}</style></body></html>