---
title: "Setting up Euterpea"
tags: code fp rc music
---

This post describes my travails setting up Euterpea on a Mac (OS 10.15.6).

Suggestions for improving the procedure are most welcome. It would be
very good if someone could verify the procedure on a "clean" machine
to ensure that it is correct, complete, and *reproducible.*

There are a number of challenges

1. Installing GHC  
2. Installing Euterpea
3. Installing a synthesizer
4. Configuration: the synthesizer and Euterpea need to talk to eachother.

## Installing GHC  

I used the installer at [haskell.org](https://www.haskell.org/platform/mac.html).
It gives you ghc, cabal, and stack.

This part went well.

## Installing Euterpea  

This is tricky. The best resource is
the [download and installation page](http://www.euterpea.com/download-and-installation/) of
[euterpea.com](http://www.euterpea.com/).
It is important to use the right version of GHC in installing Euterpea. If you
do not, installation will fail.  It is recommended to use cabal for installation,
but I prefer stack.  While it is said that you cannot presently use stack, it is
indeed possible if you [have the correct instructions](https://stackoverflow.com/questions/53977864/installing-euterpea-for-computer-music-applications-and-haskell#comment94979685_54072767).
Here is what to do.

### 1. Set up a new project: `stack new euterpea`

If you `cd euterpea`, you get this:

```
$ tree
.
├── ChangeLog.md
├── LICENSE
├── README.md
├── Setup.hs
├── app
│   └── Main.hs
├── eutx.cabal
├── package.yaml
├── src
│   └── Lib.hs
├── stack.yaml
└── test
   └── Spec.hs
```

#### Getting the correct version of GCH

Look at `stack.yaml` and find the line which looks something
like `resolver: lts-16.13`. The `lts`
stands for *long-time support*. This line determines the version of
GHC.  Note that version numbers for `lts` and `ghc` are not the same.

According to the [download and installation page](http://www.euterpea.com/download-and-installation/),
you must use a GHC version in the range 8.2 through 8.6.5. Change
`lts-*.*`  to `lts-12.26`.  This will ensure that GHC 8.4.4 is used.
If you now run `stack ghci`, GHCi will come up, reporting version 8.4.4.


#### Setting the dependencies (stack.yaml)

Still in `stack.yaml`, define the extra dependencies:

```
extra-deps:
- Euterpea-2.0.6
- PortMidi-0.1.6.1
- arrows-0.4.4.2
- Stream-0.4.7.2
- lazysmallcheck-0.6
```

#### Setting the dependencies (package.yaml)

Modify `package.yaml` so that the `dependencies` section looks like this:

```
dependencies:
- base >= 4.7 && < 5
- Euterpea
```

Run `stack ghci` again, and try this:

```
*Main Lib> import Euterpea
*Main Lib Euterpea>
*Main Lib Euterpea> note (1/4) (A, 4)
Prim (Note (1 % 4) (A,4))
```

If you get as far as seeing `Prim (Note (1 % 4) (A,4))`, you know that Euterpea is
properly installed.
